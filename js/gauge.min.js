function domReady(e){window.addEventListener?window.addEventListener("DOMContentLoaded",e,!1):window.attachEvent("onload",e)}var Gauge=function(e){function t(e,a){for(var i in a)"object"==typeof a[i]&&"[object Array]"!==Object.prototype.toString.call(a[i])&&"renderTo"!=i?("object"!=typeof e[i]&&(e[i]={}),t(e[i],a[i])):e[i]=a[i]}function a(){M.width=e.width,M.height=e.height,k=M.cloneNode(!0),j=k.getContext("2d"),x=M.width,V=M.height,S=x/2,C=V/2,P=C>S?S:C,k.i8d=!1,j.translate(S,C),j.save(),I.translate(S,C),I.save()}function i(e){var t=new Date;A=setInterval(function(){var a=(new Date-t)/e.duration;a>1&&(a=1);var i=("function"==typeof e.delta?e.delta:F[e.delta])(a);e.step(i),1==a&&clearInterval(A)},e.delay||10)}function n(){A&&clearInterval(A);var t=b-p,a=p,n=e.animation;i({delay:n.delay,duration:n.duration,delta:n.fn,step:function(e){p=parseFloat(a)+t*e,y.draw()}})}function o(e){return e*Math.PI/180}function r(e,t,a){return a=I.createLinearGradient(0,0,0,a),a.addColorStop(0,e),a.addColorStop(1,t),a}function l(){var t=93*(P/100),a=P-t,i=91*(P/100),n=88*(P/100),o=85*(P/100);I.save(),e.glow&&(I.shadowBlur=a,I.shadowColor="rgba(0, 0, 0, 0.5)"),I.beginPath(),I.arc(0,0,t,0,2*Math.PI,!0),I.fillStyle=r("#ddd","#aaa",t),I.fill(),I.restore(),I.beginPath(),I.arc(0,0,i,0,2*Math.PI,!0),I.fillStyle=r("#fafafa","#ccc",i),I.fill(),I.beginPath(),I.arc(0,0,n,0,2*Math.PI,!0),I.fillStyle=r("#eee","#f0f0f0",n),I.fill(),I.beginPath(),I.arc(0,0,o,0,2*Math.PI,!0),I.fillStyle=e.colors.plate,I.fill(),I.save()}function s(t){var a=!1;return t=0===e.majorTicksFormat.dec?Math.round(t).toString():t.toFixed(e.majorTicksFormat.dec),1<e.majorTicksFormat["int"]?(a=-1<t.indexOf("."),-1<t.indexOf("-")?"-"+(e.majorTicksFormat["int"]+e.majorTicksFormat.dec+2+(a?1:0)-t.length)+t.replace("-",""):""+(e.majorTicksFormat["int"]+e.majorTicksFormat.dec+1+(a?1:0)-t.length)+t):t}function c(){var t=81*(P/100);if(I.lineWidth=2,I.strokeStyle=e.colors.majorTicks,I.save(),0===e.majorTicks.length){for(var a=(e.maxValue-e.minValue)/5,i=0;5>i;i++)e.majorTicks.push(s(e.minValue+a*i));e.majorTicks.push(s(e.maxValue))}for(i=0;i<e.majorTicks.length;++i)I.rotate(o(45+i*(270/(e.majorTicks.length-1)))),I.beginPath(),I.moveTo(0,t),I.lineTo(0,t-15*(P/100)),I.stroke(),I.restore(),I.save();e.strokeTicks&&(I.rotate(o(90)),I.beginPath(),I.arc(0,0,t,o(45),o(315),!1),I.stroke(),I.restore(),I.save())}function d(){var t=81*(P/100);I.lineWidth=1,I.strokeStyle=e.colors.minorTicks,I.save();for(var a=e.minorTicks*(e.majorTicks.length-1),i=0;a>i;++i)I.rotate(o(45+i*(270/a))),I.beginPath(),I.moveTo(0,t),I.lineTo(0,t-7.5*(P/100)),I.stroke(),I.restore(),I.save()}function u(){for(var t=55*(P/100),a=0;a<e.majorTicks.length;++a){var i=f(t,o(45+a*(270/(e.majorTicks.length-1))));I.font=20*(P/200)+"px Arial",I.fillStyle=e.colors.numbers,I.lineWidth=0,I.textAlign="center",I.fillText(e.majorTicks[a],i.x,i.y+3)}}function h(t){var a=e.valueFormat.dec,i=e.valueFormat["int"];t=parseFloat(t);var n=0>t;if(t=Math.abs(t),a>0){for(t=t.toFixed(a).toString().split("."),a=0,i-=t[0].length;i>a;++a)t[0]="0"+t[0];t=(n?"-":"")+t[0]+"."+t[1]}else{for(t=Math.round(t).toString(),a=0,i-=t.length;i>a;++a)t="0"+t;t=(n?"-":"")+t}return t}function f(e,t){var a=Math.sin(t),i=Math.cos(t);return{x:0*i-e*a,y:0*a+e*i}}function g(){I.save();for(var t=81*(P/100),a=t-15*(P/100),i=0,n=e.highlights.length;n>i;i++){var r=e.highlights[i],l=(e.maxValue-e.minValue)/270,s=o(45+(r.from-e.minValue)/l),l=o(45+(r.to-e.minValue)/l);I.beginPath(),I.rotate(o(90)),I.arc(0,0,t,s,l,!1),I.restore(),I.save();var c=f(a,s),d=f(t,s);I.moveTo(c.x,c.y),I.lineTo(d.x,d.y);var d=f(t,l),u=f(a,l);I.lineTo(d.x,d.y),I.lineTo(u.x,u.y),I.lineTo(c.x,c.y),I.closePath(),I.fillStyle=r.color,I.fill(),I.beginPath(),I.rotate(o(90)),I.arc(0,0,a,s-.2,l+.2,!1),I.restore(),I.closePath(),I.fillStyle=e.colors.plate,I.fill(),I.save()}}function m(){var t=12*(P/100),a=8*(P/100),i=77*(P/100),n=20*(P/100),l=4*(P/100),s=2*(P/100),c=function(){I.shadowOffsetX=2,I.shadowOffsetY=2,I.shadowBlur=10,I.shadowColor="rgba(188, 143, 143, 0.45)"};c(),I.save(),p=0>p?Math.abs(e.minValue-p):0<e.minValue?p-e.minValue:Math.abs(e.minValue)+p,I.rotate(o(45+p/((e.maxValue-e.minValue)/270))),I.beginPath(),I.moveTo(-s,-n),I.lineTo(-l,0),I.lineTo(-1,i),I.lineTo(1,i),I.lineTo(l,0),I.lineTo(s,-n),I.closePath(),I.fillStyle=r(e.colors.needle.start,e.colors.needle.end,i-n),I.fill(),I.beginPath(),I.lineTo(-.5,i),I.lineTo(-1,i),I.lineTo(-l,0),I.lineTo(-s,-n),I.lineTo(s/2-2,-n),I.closePath(),I.fillStyle="rgba(255, 255, 255, 0.2)",I.fill(),I.restore(),c(),I.beginPath(),I.arc(0,0,t,0,2*Math.PI,!0),I.fillStyle=r("#f0f0f0","#ccc",t),I.fill(),I.restore(),I.beginPath(),I.arc(0,0,a,0,2*Math.PI,!0),I.fillStyle=r("#e8e8e8","#f5f5f5",a),I.fill()}function v(){I.save(),I.font=40*(P/200)+"px Led";var e=h(T),t=I.measureText("-"+h(0)).width,a=P-33*(P/100),i=.12*P;I.save();var n=-t/2-.025*P,o=a-i-.04*P,t=t+.05*P,i=i+.07*P,r=.025*P;I.beginPath(),I.moveTo(n+r,o),I.lineTo(n+t-r,o),I.quadraticCurveTo(n+t,o,n+t,o+r),I.lineTo(n+t,o+i-r),I.quadraticCurveTo(n+t,o+i,n+t-r,o+i),I.lineTo(n+r,o+i),I.quadraticCurveTo(n,o+i,n,o+i-r),I.lineTo(n,o+r),I.quadraticCurveTo(n,o,n+r,o),I.closePath(),n=I.createRadialGradient(0,a-.12*P-.025*P+(.12*P+.045*P)/2,P/10,0,a-.12*P-.025*P+(.12*P+.045*P)/2,P/5),n.addColorStop(0,"#888"),n.addColorStop(1,"#666"),I.strokeStyle=n,I.lineWidth=.05*P,I.stroke(),I.shadowBlur=.012*P,I.shadowColor="rgba(0, 0, 0, 1)",I.fillStyle="#babab2",I.fill(),I.restore(),I.shadowOffsetX=.004*P,I.shadowOffsetY=.004*P,I.shadowBlur=.012*P,I.shadowColor="rgba(0, 0, 0, 0.3)",I.fillStyle="#444",I.textAlign="center",I.fillText(e,-0,a),I.restore()}Gauge.Collection.push(this),this.config={renderTo:null,width:200,height:200,title:!1,maxValue:100,minValue:0,majorTicks:[],minorTicks:10,strokeTicks:!0,units:!1,valueFormat:{"int":3,dec:2},majorTicksFormat:{"int":1,dec:0},glow:!0,animation:{delay:10,duration:250,fn:"cycle"},colors:{plate:"#fff",majorTicks:"#444",minorTicks:"#666",title:"#888",units:"#888",numbers:"#444",needle:{start:"rgba(240, 128, 128, 1)",end:"rgba(255, 160, 122, .9)"}},highlights:[{from:20,to:60,color:"#eee"},{from:60,to:80,color:"#ccc"},{from:80,to:100,color:"#999"}]};var T=0,y=this,p=0,b=0,w=!1;if(this.setValue=function(t){p=e.animation?T:t;var a=(e.maxValue-e.minValue)/100;return b=t>e.maxValue?e.maxValue+a:t<e.minValue?e.minValue-a:t,T=t,e.animation?n():this.draw(),this},this.setRawValue=function(e){return p=T=e,this.draw(),this},this.clear=function(){return T=p=b=this.config.minValue,this.draw(),this},this.getValue=function(){return T},this.onready=function(){},t(this.config,e),this.config.minValue=parseFloat(this.config.minValue),this.config.maxValue=parseFloat(this.config.maxValue),e=this.config,p=T=e.minValue,!e.renderTo)throw Error("Canvas element was not specified when creating the Gauge object!");var k,x,V,S,C,P,j,M=e.renderTo.tagName?e.renderTo:document.getElementById(e.renderTo),I=M.getContext("2d");a(),this.updateConfig=function(e){return t(this.config,e),a(),this.draw(),this};var F={linear:function(e){return e},quad:function(e){return Math.pow(e,2)},quint:function(e){return Math.pow(e,5)},cycle:function(e){return 1-Math.sin(Math.acos(e))},bounce:function(e){e:{e=1-e;for(var t=0,a=1;;t+=a,a/=2)if(e>=(7-4*t)/11){e=-Math.pow((11-6*t-11*e)/4,2)+Math.pow(a,2);break e}e=void 0}return 1-e},elastic:function(e){return e=1-e,1-Math.pow(2,10*(e-1))*Math.cos(30*Math.PI/3*e)}},A=null;I.lineCap="round",this.draw=function(){if(!k.i8d){j.clearRect(-S,-C,x,V),j.save();var t={ctx:I};I=j,l(),g(),d(),c(),u(),e.title&&(I.save(),I.font=24*(P/200)+"px Arial",I.fillStyle=e.colors.title,I.textAlign="center",I.fillText(e.title,0,-P/4.25),I.restore()),e.units&&(I.save(),I.font=22*(P/200)+"px Arial",I.fillStyle=e.colors.units,I.textAlign="center",I.fillText(e.units,0,P/3.25),I.restore()),k.i8d=!0,I=t.ctx,delete t.ctx}if(I.clearRect(-S,-C,x,V),I.save(),I.drawImage(k,-S,-C,x,V),Gauge.initialized)v(),m(),w||(y.onready&&y.onready(),w=!0);else var a=setInterval(function(){Gauge.initialized&&(clearInterval(a),v(),m(),w||(y.onready&&y.onready(),w=!0))},10);return this}};Gauge.initialized=!1,function(){var e=document,t=e.getElementsByTagName("head")[0],a=-1!=navigator.userAgent.toLocaleLowerCase().indexOf("msie"),i="@font-face {font-family: 'Led';src: url('http://smart-ip.net/styles/fonts/digital-7-mono."+(a?"eot":"ttf")+"');}",n=e.createElement("style");if(n.type="text/css",a)t.appendChild(n),t=n.styleSheet,t.cssText=i;else{try{n.appendChild(e.createTextNode(i))}catch(o){n.cssText=i}t.appendChild(n),t=n.styleSheet?n.styleSheet:n.sheet||e.styleSheets[e.styleSheets.length-1]}var r=setInterval(function(){if(e.body){clearInterval(r);var t=e.createElement("div");t.style.fontFamily="Led",t.style.position="absolute",t.style.height=t.style.width=0,t.style.overflow="hidden",t.innerHTML=".",e.body.appendChild(t),setTimeout(function(){Gauge.initialized=!0,t.parentNode.removeChild(t)},250)}},1)}(),Gauge.Collection=[],Gauge.Collection.get=function(e){if("string"!=typeof e)return"number"==typeof e?this[e]:null;for(var t=0,a=this.length;a>t;t++)if(this[t].config.renderTo.getAttribute("id")==e)return this[t]},domReady(function(){function b(e){for(var t=e[0],a=1,i=e.length;i>a;a++)t+=e[a].substr(0,1).toUpperCase()+e[a].substr(1,e[a].length-1);return t}for(var l=document.getElementsByTagName("canvas"),q=0,v=l.length;v>q;q++)if("canv-gauge"==l[q].getAttribute("data-type")){var k=l[q],e={},g,n=parseInt(k.getAttribute("width"),10),w=parseInt(k.getAttribute("height"),10);for(e.renderTo=k,n&&(e.width=n),w&&(e.height=w),n=0,w=k.attributes.length;w>n;n++)if(g=k.attributes.item(n).nodeName,"data-type"!=g&&"data-"==g.substr(0,5)){var d=g.substr(5,g.length-5).toLowerCase().split("-");if(g=k.getAttribute(g))switch(d[0]){case"colors":d[1]&&(e.colors||(e.colors={}),"needle"==d[1]?(d=g.split(/\s+/),e.colors.needle=d[0]&&d[1]?{start:d[0],end:d[1]}:g):(d.shift(),e.colors[b(d)]=g));break;case"highlights":e.highlights||(e.highlights=[]),g=g.split(",");for(var d=0,J=g.length;J>d;d++){var s=g[d].replace(/^\s+|\s+$/g,"").split(/\s+/),x={};s[0]&&""!=s[0]&&(x.from=s[0]),s[1]&&""!=s[1]&&(x.to=s[1]),s[2]&&""!=s[2]&&(x.color=s[2]),e.highlights.push(x)}break;case"animation":d[1]&&(e.animation||(e.animation={}),"fn"==d[1]&&/^\s*function\s*\(/.test(g)&&(g=eval("("+g+")")),e.animation[d[1]]=g);break;default:if(d=b(d),"onready"==d)continue;if("majorTicks"==d)g=g.split(/\s+/);else if("strokeTicks"==d||"glow"==d)g="true"==g?!0:!1;else if("valueFormat"==d){if(g=g.split("."),2!=g.length)continue;g={"int":parseInt(g[0],10),dec:parseInt(g[1],10)}}e[d]=g}}e=new Gauge(e),k.getAttribute("data-value")&&e.setRawValue(parseFloat(k.getAttribute("data-value"))),k.getAttribute("data-onready")&&(e.onready=function(){eval(this.config.renderTo.getAttribute("data-onready"))}),e.draw()}}),window.Gauge=Gauge;