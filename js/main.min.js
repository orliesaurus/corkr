window.setGauge=function(e){Gauge.Collection.get("gauge").setValue(parseInt(e))},$(document).ready(function(){function e(e){void 0!==i&&i.remove(),i=L.map("map",{zoomControl:!1,minZoom:5,attributionControl:!1}).setView([54.5,-3],6),L.tileLayer("https://{s}.tiles.mapbox.com/v3/m6-d6.hfccch9n/{z}/{x}/{y}.png",{}).addTo(i),$.getJSON(e,function(e){for(var r=0;r<e.length;r++)ll=e[r].latlong,null!==ll&&(latlong=ll.split(","),name=e[r].name,score=e[r].score,url=e[r].url,0===score?(thisMarker=t,color="green"):6>score?(thisMarker=o,color="orange"):(thisMarker=a,color="red"),L.marker(latlong,{riseOnHover:"true",title:name,icon:thisMarker,score:score,cData:color,url:url}).on("click",n).addTo(i))})}function n(e){dataSource=e.target.options,name=dataSource.title,url=dataSource.url,score=dataSource.score,cData=dataSource.cData,$(".item-info").removeClass("green orange red"),$(".item-info").addClass(cData),$(".item-info").find(".url").children().html(url.slice(0,-5)),$(".item-info").find(".description").html(name),window.setGauge(score),$(".item-info").hasClass("active")?($(".item-info").removeClass("active"),$(".item-info").bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){$(".item-info").addClass("active"),$(".item-info").unbind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd")})):$(".item-info").addClass("active")}$(".info-btn").click(function(){$(".app-header").toggleClass("active")}),$("body").click(function(){$(".item-info").hasClass("active")&&($(".item-info").removeClass("active"),window.setGauge(0))});var i,t=L.icon({iconUrl:"img/marker-green-x2.png",iconSize:[10,10]}),o=L.icon({iconUrl:"img/marker-orange-x2.png",iconSize:[10,10]}),a=L.icon({iconUrl:"img/marker-red-x2.png",iconSize:[10,10]});e("js/pretty.json"),$(".domain-btns button").click(function(){$(".domain-btns button").removeClass("active"),$(this).addClass("active"),attrs=this.attributes[0].nodeValue.split(" "),fileName="nhs"===attrs[0]?"js/nhs.json":"js/pretty.json",e(fileName)});var r=new r({renderTo:"gauge"});gauge.onready=function(){setInterval(function(){gauge.setValue(100*Math.random())},1e3)},gauge.draw()});